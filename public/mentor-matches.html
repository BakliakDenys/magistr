<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ —Å—Ç–∞—Ä—Ç–∞–ø–∏</title>
  <link rel="stylesheet" href="styles.css" />
   <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
  <style>
      body.hidden { display: none; }
    body *:not(button):not(.nav-button) {
      font-family: 'Patrick Hand', cursive;
    }

    .card-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }

    .startup-card {
      background: black;
      border-radius: 16px;
      width: 350px;
      padding: 20px;
      transition: transform 0.3s ease;
      box-shadow: 0px 0px 20px white;
    }

    .startup-card:hover {
      transform: translateY(-5px);
      box-shadow: 0px 0px 20px darkred;
    }

    .startup-card img {
      width: 100%;
      box-shadow: 0px 0px 10px darkred;
      height: 160px;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 10px;
    }

    .startup-card:hover img {
  box-shadow: 0px 0px 10px white;
}

.startup-card p {
  margin: 8px 0;
  font-size: 16px;
  color: white;
  line-height: 1.4;
}

/* –í—ñ–¥—Å—Ç—É–ø –¥–ª—è –∫–Ω–æ–ø–∫–∏ */
.startup-card .nav-button {
  display: inline-block;
  margin-top: 12px;
  margin-bottom: 10px;
  padding: 10px 20px;
  background-color: black;
  color: white;
  border-radius: 10px;
  text-decoration: none;
  font-weight: bold;
  box-shadow: 0 0 10px white;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
}

.startup-card .nav-button:hover {
  background-color: darkred;
  box-shadow: 0 0 15px red;
}

/* Email –∑ –≤—ñ–¥—Å—Ç—É–ø–æ–º –∑–≥–æ—Ä–∏ */
.startup-card .owner-info {
  margin-top: 12px;
}


    .learn-more {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 16px;
      background-color: #4CAF50;
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: background 0.3s ease;
    }

    .learn-more:hover {
      background-color: #388e3c;
    }
  </style>
</head>
<body>

<!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å -->
<div class="top-bar">
  <img id="avatarImage" alt="–ê–≤–∞—Ç–∞—Ä" class="avatar2">
  <div class="user-email" id="userEmail">email@example.com</div>
  <button id="authButton" class="logout-btn nav-button"></button>
</div>


  <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è -->
<!-- –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–µ–Ω—é -->
<button id="menuToggle" class="nav-button">‚ò∞ –ú–µ–Ω—é</button>

<!-- –ë–æ–∫–æ–≤–µ –º–µ–Ω—é -->
<div id="sideMenu" class="side-menu">
  <a href="/" class="nav-button">–ì–æ–ª–æ–≤–Ω–∞</a>
  <a href="/profile.html" class="nav-button">–ü—Ä–æ—Ñ—ñ–ª—å</a>
  <a href="/users.html" class="nav-button">–í—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ</a>
  <a href="/about.html" class="nav-button">–í—ñ–¥–≥—É–∫–∏</a>
  <a href="/mentor-matches.html" class="nav-button" id="recommendBtn">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –ø—Ä–æ—î–∫—Ç–∏</a>
  <button id="createMeetingToggle" class="nav-button submenu-toggle">
   –ó—É—Å—Ç—Ä—ñ—á—ñ ‚ñº
  </button>
  <div id="createMeetingSubmenu" class="submenu">
    <a href="/create-meeting.html" class="nav-button">‚ûï –ù–æ–≤–∞ –∑—É—Å—Ç—Ä—ñ—á</a>
    <a href="/meetings.html" class="nav-button">üìã –í—Å—ñ –∑—É—Å—Ç—Ä—ñ—á—ñ</a>
  </div>
</div>

<a href="/" class="floating-logo">
  <img src="/logo.PNG" alt="–õ–æ–≥–æ—Ç–∏–ø">
</a>
  
<h4 id="pageTitle" style="visibility: hidden;">–í–∞—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h4>
  <div class="card-container" id="matchesContainer">
    <!-- –ö–∞—Ä—Ç–∏ —Å—Ç–∞—Ä—Ç–∞–ø—ñ–≤ –∑'—è–≤–ª—è—Ç—å—Å—è —Ç—É—Ç -->
  </div>

  <script src="/script.js"></script>
  <script>
  const token = localStorage.getItem('token');
  const email = localStorage.getItem('email');
  const selectedStartupEmail = localStorage.getItem('selectedStartup');

  if (!token) {
    alert('–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å —É —Å–∏—Å—Ç–µ–º—É.');
    window.location.href = '/login.html';
  }

  fetch('/api/mentor/matches', {
    headers: {
      'Authorization': `Bearer ${token}`
    }
  })
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById('matchesContainer');
    if (!Array.isArray(data)) {
      container.innerHTML = '<p>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó.</p>';
      return;
    }

    if (data.length === 0) {
      container.innerHTML = '<p>–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Å—Ç–∞—Ä—Ç–∞–ø—ñ–≤.</p>';
      return;
    }

    data.forEach(startup => {
      const card = document.createElement('div');
      card.className = 'startup-card';

      card.innerHTML = `
        <img src="${startup.avatarUrl || 'default-avatar.png'}" alt="–ê–≤–∞—Ç–∞—Ä —Å—Ç–∞—Ä—Ç–∞–ø—É">
        <p><strong>–ù–∞–∑–≤–∞ –ø—Ä–æ—î–∫—Ç—É:</strong> ${startup.name}</p>
        <p><strong>–ì–∞–ª—É–∑—å:</strong> ${startup.industry}</p>
        <p><strong>–°—Ç–∞–¥—ñ—è:</strong> ${startup.stage}</p>
        <p>${startup.description}</p>
        <button class="nav-button">${startup.email === selectedStartupEmail ? '–ó–∞–≤–µ—Ä—à–∏—Ç–∏' : '–í–∏–±—Ä–∞—Ç–∏'}</button>
        <div class="owner-info" style="display:${startup.email === selectedStartupEmail ? 'block' : 'none'}; margin-top:10px;">
          <p><strong>Email –≤–ª–∞—Å–Ω–∏–∫–∞:</strong> ${startup.email}</p>
        </div>
      `;

      const button = card.querySelector('button');
      const ownerInfo = card.querySelector('.owner-info');

      button.addEventListener('click', () => {
        const allCards = document.querySelectorAll('.startup-card');
   if (button.textContent === '–í–∏–±—Ä–∞—Ç–∏') {
  allCards.forEach(c => {
    if (c !== card) c.style.display = 'none';
  });
  ownerInfo.style.display = 'block';
  button.textContent = '–ó–∞–≤–µ—Ä—à–∏—Ç–∏';
  localStorage.setItem('selectedStartup', startup.email);

  document.getElementById('pageTitle').textContent = '–°—Ç–∞—Ä—Ç–∞–ø, —è–∫–∏–π –≤–∏ –≤–µ–¥–µ—Ç–µ –¥–æ –º–µ—Ç–∏';

  fetch(`/api/startup/reserve`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify({ startupEmail: startup.email })
  });

} else {
  allCards.forEach(c => c.style.display = 'block');
  ownerInfo.style.display = 'none';
  button.textContent = '–í–∏–±—Ä–∞—Ç–∏';
  localStorage.removeItem('selectedStartup');

  document.getElementById('pageTitle').textContent = '–í–∞—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó';

  fetch(`/api/startup/unreserve`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify({ startupEmail: startup.email })
  });
}

      });

      container.appendChild(card);
    });
    const title = document.getElementById('pageTitle');
if (selectedStartupEmail) {
  const allCards = document.querySelectorAll('.startup-card');
  allCards.forEach(card => {
    if (!card.innerHTML.includes(selectedStartupEmail)) {
      card.style.display = 'none';
    }
  });
  title.textContent = '–°—Ç–∞—Ä—Ç–∞–ø, —è–∫–∏–π –≤–∏ –≤–µ–¥–µ—Ç–µ –¥–æ –º–µ—Ç–∏';
} else {
  title.textContent = '–í–∞—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó';
}
title.style.visibility = 'visible';


    // –ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ ‚Äî —è–∫—â–æ —î –≤–∏–±—Ä–∞–Ω–∏–π, –ø—Ä–∏—Ö–æ–≤–∞–π —ñ–Ω—à—ñ
    if (selectedStartupEmail) {
      const allCards = document.querySelectorAll('.startup-card');
      allCards.forEach(card => {
        document.getElementById('pageTitle').textContent = '–°—Ç–∞—Ä—Ç–∞–ø, —è–∫–∏–π –≤–∏ –≤–µ–¥–µ—Ç–µ –¥–æ –º–µ—Ç–∏';
        if (!card.innerHTML.includes(selectedStartupEmail)) {
          card.style.display = 'none';
        }
      });
    }

  })
  .catch(err => {
    console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ:', err);
    document.getElementById('matchesContainer').innerHTML = '<p>–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ.</p>';
  });
</script>
</body>
</html>
