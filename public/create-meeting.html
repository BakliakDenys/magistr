<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—É—Å—Ç—Ä—ñ—á—ñ</title>
  <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
  <style>
    body.hidden { display: none; }
    body *:not(button):not(.nav-button) {
      font-family: 'Patrick Hand', cursive;
    }
  </style>
</head>
<body class="hidden ">

  <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å -->
<div class="top-bar">
  <img id="avatarImage" alt="–ê–≤–∞—Ç–∞—Ä" class="avatar2">
  <div class="user-email" id="userEmail">email@example.com</div>
  <button id="authButton" class="logout-btn nav-button"></button>
</div>
  
 <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è -->
<!-- –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–µ–Ω—é -->
<button id="menuToggle" class="nav-button">‚ò∞ –ú–µ–Ω—é</button>

<!-- –ë–æ–∫–æ–≤–µ –º–µ–Ω—é -->
<div id="sideMenu" class="side-menu">
  <a href="/" class="nav-button">–ì–æ–ª–æ–≤–Ω–∞</a>
  <a href="/profile.html" class="nav-button">–ü—Ä–æ—Ñ—ñ–ª—å</a>
  <a href="/users.html" class="nav-button">–í—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ</a>
  <a href="/about.html" class="nav-button">–í—ñ–¥–≥—É–∫–∏</a>
  <button id="createMeetingToggle" class="nav-button submenu-toggle">
    –ó—É—Å—Ç—Ä—ñ—á—ñ ‚ñº
  </button>
  <div id="createMeetingSubmenu" class="submenu">
    <a href="/create-meeting.html" class="nav-button">‚ûï –ù–æ–≤–∞ –∑—É—Å—Ç—Ä—ñ—á</a>
    <a href="/meetings.html" class="nav-button">üìã –í—Å—ñ –∑—É—Å—Ç—Ä—ñ—á—ñ</a>
  </div>
</div>

<a href="/" class="floating-logo">
  <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø">
</a>
  <form id="meetingForm" enctype="multipart/form-data" method="POST">
    <h4>–°—Ç–≤–æ—Ä–∏—Ç–∏ –∑—É—Å—Ç—Ä—ñ—á</h4>
 <div class="info-row">
<label>–ö–∞—Ä—Ç–∏–Ω–∫–∞:</label>
<input type="file" name="image" id="meetingImage" required hidden accept="image/*">
<button type="button" class="nav-button" onclick="document.getElementById('meetingImage').click()">–í–∏–±—Ä–∞—Ç–∏ —Ñ–æ—Ç–æ</button>
<img id="imagePreview" src="#" alt="–ü—Ä–µ–≤‚Äô—é —Ñ–æ—Ç–æ" />
<span id="fileName"></span>


    <label>–¢–µ–º–∞:
      <input type="text" name="title" required>
    </label>

    <label>–¢–∏–ø –∑—É—Å—Ç—Ä—ñ—á—ñ:
      <select name="type" required>
        <option value="–õ–µ–∫—Ü—ñ—è">–õ–µ–∫—Ü—ñ—è</option>
        <option value="–¢—Ä–µ–Ω—ñ–Ω–≥">–¢—Ä–µ–Ω—ñ–Ω–≥</option>
        <option value="–û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è">–û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è</option>
        <option value="–í—Å–µ —Ä–∞–∑–æ–º">–í—Å–µ —Ä–∞–∑–æ–º</option>
      </select>
    </label>

    <label>–§–æ—Ä–º–∞—Ç:
      <select name="format" required>
        <option value="–û–Ω–ª–∞–π–Ω">–û–Ω–ª–∞–π–Ω</option>
        <option value="–û—Ñ–ª–∞–π–Ω">–û—Ñ–ª–∞–π–Ω</option>
      </select>
    </label>

    <label>–ú—ñ—Å—Ü–µ:
      <input type="text" name="location" required>
    </label>

    <label>–î–∞—Ç–∞:
      <input type="date" name="date" required>
    </label>

    <label>–ü–æ—á–∞—Ç–æ–∫:
      <input type="time" name="startTime" required>
    </label>

    <label>–ö—ñ–Ω–µ—Ü—å:
      <input type="time" name="endTime" required>
    </label>

    <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—á–∞—Å–Ω–∏–∫—ñ–≤:
      <input type="number" name="maxParticipants" min="1" required>
    </label>

    <label>–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ:
      <textarea name="description" rows="5" required></textarea>
    </label>
</div>
    <button type="submit" class="nav-button">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
  </form>

  <script src="create-meeting.js"></script>
    <script src="meetings.js"></script>
    <script src="script.js"></script>
    <script>
  const input = document.getElementById('meetingImage');
  const fileName = document.getElementById('fileName');

  input.addEventListener('change', () => {
    if (input.files.length > 0) {
      fileName.textContent = '–û–±—Ä–∞–Ω–æ —Ñ–∞–π–ª: ' + input.files[0].name;
    } else {
      fileName.textContent = '';
    }
  });

    const meetingImageInput = document.getElementById('meetingImage');
  const fileNameSpan = document.getElementById('fileName');
  const imagePreview = document.getElementById('imagePreview');

  meetingImageInput.addEventListener('change', function () {
    const file = this.files[0];
    if (file) {
      fileNameSpan.textContent = file.name;

      const reader = new FileReader();
      reader.onload = function (e) {
        imagePreview.src = e.target.result;
        imagePreview.style.display = 'block';
      }
      reader.readAsDataURL(file);
    } else {
      fileNameSpan.textContent = '';
      imagePreview.style.display = 'none';
    }
  });

</script>
    <script>
  const token = localStorage.getItem('token');

  if (!token) {
    alert('–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏.');
    window.location.href = '/login.html';
  }

  const form = document.getElementById('meetingForm');
  form.addEventListener('submit', async (e) => {
    e.preventDefault(); // –ó–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é —Å—Ç–æ—Ä—ñ–Ω–∫–∏

    const formData = new FormData(form); // –ó–±–∏—Ä–∞—î –≤—Å—ñ –¥–∞–Ω—ñ —Ñ–æ—Ä–º–∏, –≤–∫–ª—é—á–∞—é—á–∏ —Ñ–∞–π–ª

    try {
      const response = await fetch('/api/meetings', {
        method: 'POST',
        body: formData, // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î —Ñ–æ—Ä–º—É —è–∫ FormData (—è–∫–∞ –≤–∫–ª—é—á–∞—î —Ñ–∞–π–ª–∏)
        headers: {
          'Authorization': `Bearer ${token}`, // –î–æ–¥–∞—î —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        },
      });

      if (response.ok) {
        const data = await response.json();
        console.log('–ó—É—Å—Ç—Ä—ñ—á —Å—Ç–≤–æ—Ä–µ–Ω–∞:', data);
        alert('–ó—É—Å—Ç—Ä—ñ—á —Å—Ç–≤–æ—Ä–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ!');
          window.location.href = '/meetings.html';
      } else {
        const errorData = await response.json();
        console.error('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑—É—Å—Ç—Ä—ñ—á—ñ:', errorData.message);
        alert('–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∑—É—Å—Ç—Ä—ñ—á—ñ');
      }
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É:', error);
      alert('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—ñ –∑–∞–ø–∏—Ç—É');
    }
  });

</script>

</body>
</html>
